<html>

<head>
    <meta charset="utf-8">
    <!-- 引入 ECharts 文件 -->
    <link rel="stylesheet" href="./Openlayer/ol.css" type="text/css">
    <link rel="stylesheet" href="./ol-infowindow/style.css" type="text/css">
    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script src="./Openlayer/ol.js"></script>
    <script src="./ol-infowindow/main.js"></script>

    <style>
        #map {
            width: 100%;
            height: 100%
        }
    </style>
</head>

<body>

    <div id="map"></div>
   
    <script>
        var center = ol.proj.transform([117.4658331179, 31.6159870346], 'EPSG:4326', 'EPSG:3857');
        var url = "http://10.34.0.12:6080/arcgis/rest/services/ZTSLDT0717/MapServer";
        var osm = new ol.layer.Tile({
            source: new ol.source.OSM()
        });

        var arcgisLayer = new ol.layer.Tile({
            source: new ol.source.TileArcGISRest({
                url: url
            })
        })
        var map = new ol.Map({
            view: new ol.View({
                center: center,
                zoom: 8,
                maxZoom: 18
            }),
            target: 'map'
        });
         var attrs2 = {
                        title: {
                            show: true,
                            text: "你好呀",
                            textSize: "15px",
                            textColor: "#000",
                            backgroundColor: "#ddf1ff",
                            textAlign: "left"
                        },
                        width: "300px",
                        hideBefore: true,
                        closeBtn:true,
                        content: [{
                            name: "设备编码",
                            value: "12345644444444444444",
                            nameColor: "#222222",
                            valueColor: "#222222",
                            divider: false
                        }, {
                            name: "运行状态",
                            value: 1=="1"?"运行":"停止",
                            nameColor: "#222222",
                            valueColor: 1=="1"?"#00aa00":"#ff0000",
                            divider: false
                        },
                        {
                            name: "时间",
                            value: 2019,
                            nameColor: "#222222",
                            divider: false
                        },
                        {
                            name: "管理单位",
                            value: "阜阳水文局",
                            nameColor: "#222222",
                            divider: false
                        },
                        {
                            name: "警戒水位",
                            value: null,
                            nameColor: "#222222",
                            divider: false
                        },
                        {
                            name: "流量",
                            value: 1,
                            nameColor: "#222222",
                            divider: false
                        }],
                        button: {
                            show: true,
                            fullButton: {
                                text: "播放", fullCallBack: function () {
                                    alert(1);
                                }
                            }
                        }
                    };
        map.addLayer(osm);
        //map.addLayer(arcgisLayer);

        var circle = new ol.Feature({
            geometry: new ol.geom.Point(center)
        })
        circle.setStyle(new ol.style.Style({
            // image: new ol.style.Icon({
            //     src:'./images/pos.png',
            //     size:16
            // })
            image: new ol.style.Circle({
                radius: 10,
                fill: new ol.style.Fill({
                    color: 'red'
                })
            })
        }));

        var vectorLayer = new ol.layer.Vector({
            source: new ol.source.Vector({
                features: [circle]
            })
        });
        map.addLayer(vectorLayer);
        var selectSingleClick = new ol.interaction.Select({
            condition: ol.events.condition.pointerClick
        });
        selectSingleClick.on('select', function (event) {
            var pos = event.mapBrowserEvent.coordinate;
            attrs2.position = pos;
            map.addInfoWindow( attrs2)
        })
        map.addInteraction(selectSingleClick);

    </script>
</body>

</html>